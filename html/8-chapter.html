<!DOCTYPE html><html lang="ru"><head><title>8. Компилятор PL/SQL</title><meta charset="UTF-8"><link rel="icon" href="./../img/icons/database.png"><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous"><link rel="stylesheet" href="./../css/main.css"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"></head><body><nav id="menu"><a class="element" id="menu-switch"><div class="icon-part"><i class="fas fa-bars"></i></div><div class="text-part"></div></a><a class="element" href="../index.html"><div class="icon-part"><i class="fas fa-home"></i></div><div class="text-part">На главную</div></a><a class="element link" href="https://github.com/Ruminat/PL-SQL-labs"><div class="icon-part"><i class="fab fa-github"></i></div><div class="text-part">GitHub</div></a></nav><div id="main"><div class="header"><h2>8. Компилятор PL/SQL</h2></div><div class="section" id="secion-1"><!-- - sections.push({number: section, title: title});--><a class="section-link" id="section-1"><h4 class="section-header">1. Использование компилятора PL/SQL</h4></a></div><ul><li>PL/SQL использует новый оптимизирующий компилятор, который может переделать код для лучшей производительности.</li><li>Производительность PL/SQL улучшена по всем направлениям.</li><li>Большинство улучшений выполняются автоматически.</li><li>Уровень оптимизации по умолчанию повышает производительность для широкого диапазона PL/SQL операций.</li></ul><p>Изменения в компиляторе PL/SQL:</p><ul><li>Уничтожение временных операндов компилятором.</li><li>Вычисление некоторых операций во время компиляции.</li><li>Повторное использование значений некоторых выражений.</li><li>Упрощение или исключение некоторых ветвей и исключение мертвого кода.</li><li>Избежание библиотечных вызовов путем прямого выполнения некоторых операций на виртуальной машине PL/SQL.</li><li>Все курсоры корректно завершаются при выходе из цикла курсора или блока Объявления.</li><li>Удаление вычислений, которые, как побочный эффект, лишь вызывают исключение.</li></ul><div class="section" id="secion-2"><!-- - sections.push({number: section, title: title});--><a class="section-link" id="section-2"><h4 class="section-header">2. Параметры инициализации для компилятора PL/SQL</h4></a></div><ul><li><code class="language-plsql">PLSQL_CODE_TYPE</code>. Задаёт режим компиляции (<u><code class="language-plsql">INTERPRETED</code></u> или <code class="language-plsql">NATIVE</code>).</li><li><code class="language-plsql">PLSQL_OPTIMIZE_LEVEL</code>. Задаёт уровень оптимизации (<code class="language-plsql">0</code>, <code class="language-plsql">1</code>, <u><code class="language-plsql">2</code></u> или <code class="language-plsql">3</code>).</li><li><code class="language-plsql">PLSQL_CCFLAGS</code>. Управляет условной компиляцией каждого модуля PL/SQL библиотеки независимо.</li><li><code class="language-plsql">PLSQL_WARNINGS</code>. Включает или отключает создание PL/SQL компилятором отчётов о предупреждениях.</li></ul><p>Как правило, для обеспечения максимальной производительности, используют следующий параметр:</p><pre class="line-numbers undefined"><code class="language-plsql">ALTER SESSION SET PLSQL_CODE_TYPE      = 'NATIVE';
ALTER SESSION SET PLSQL_OPTIMIZE_LEVEL = 2;
</code></pre><p>Настройки PL/SQL объектов можно посмотреть в словаре <code class="language-plsql">USER|ALL|DBA_PLSQL_OBJECT_SETTINGS</code>.</p><pre class="line-numbers undefined"><code class="language-plsql">SELECT Name, Type, PLSQL_Debug, PLSQL_Code_Type, PLSQL_Optimize_Level
FROM USER_PLSQL_OBJECT_SETTINGS;</code></pre><row class="aligment-center"><table class="table table-SQL table-bordered table-hover table-sm"><thead class="thead-dark"><tr><th>NAME</th><th>TYPE</th><th>PLSQL_DEBUG</th><th>PLSQL_CODE_TYPE</th><th>PLSQL_OPTIMIZE_LEVEL</th></tr></thead><tbody><tr><td>ADD_EMPLOYEE</td><td>PROCEDURE</td><td>FALSE</td><td>INTERPRETED</td><td>2</td></tr><tr><td>ADD_JOB_HISTORY</td><td>PROCEDURE</td><td>FALSE</td><td>INTERPRETED</td><td>2</td></tr><tr><td>CHECK_SALARY</td><td>PROCEDURE</td><td>FALSE</td><td>INTERPRETED</td><td>2</td></tr><tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><td>VALID_DEPTID</td><td>FUNCTION</td><td>FALSE</td><td>INTERPRETED</td><td>2</td></tr><tr><td>WEB_EMPLOYEE_REPORT</td><td>PROCEDURE</td><td>FALSE</td><td>INTERPRETED</td><td>2</td></tr></tbody></table></row><div class="section" id="secion-3"><!-- - sections.push({number: section, title: title});--><a class="section-link" id="section-3"><h4 class="section-header">3. Использование предупреждений при компиляции</h4></a></div><p>Преимущества предупреждений компилятора:</p><ul><li>Делают программы более надежными и помогают избежать проблем во время выполнения.</li><li>Выявление потенциальных проблем с производительностью.</li><li>Определение факторов, приводящих к неопределенным результатам.</li></ul><p>Типы предупреждений:</p><ul><li>Серьёзные (severe).</li><li>Производительности (performance).</li><li>Информационные (informational).</li><li>Все (all).</li></ul><p>Можно управлять отображением предупреждений:</p><pre class="line-numbers undefined"><code class="language-plsql">ALTER SESSION SET plsql_warnings = 'error:severe'
                                 , 'enable:performance'
                                 , 'disable:informational'
                                 , 'error:05003'; -- 05003 — код предупреждения
</code></pre><p>В SQL*Plus просмотреть ошибки можно с помощью команды <code class="language-plsql">SHOW ERRORS;</code>.</p><p>Рекомендации по использованию <code class="language-plsql">PLSQL_WARNINGS</code>:</p><ul><li>Настройки параметра <code class="language-plsql">PLSQL_WARNINGS</code> хранятся с каждой компилируемой подпрограммой.</li><li>Если перекомпилировать подпрограмму с помощью одной из следующих инструкций, будут использованы текущие настройки для этого сеанса:<ul> <li><code class="language-plsql">CREATE OR REPLACE</code>.</li><li><code class="language-plsql">ALTER ... COMPILE</code>.</li></ul></li><li>Если перекомпилировать подпрограмму с помощью инструкции <code class="language-plsql">ALTER ... COMPILE</code> с разделом <code class="language-plsql">REUSE SETTINGS</code>, то будут использованы исходные установки, сохранённые с программой.</li></ul><div class="section" id="secion-4"><!-- - sections.push({number: section, title: title});--><a class="section-link" id="section-4"><h4 class="section-header">4. Использование пакета DBMS_WARNING</h4></a></div></div><script src="./../js/prism.js"></script><script src="./../js/setup.js"></script><script src="./../js/main.js"></script><script src="./../js/synopsis.js"></script></body></html>